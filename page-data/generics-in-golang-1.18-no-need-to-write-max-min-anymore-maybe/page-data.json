{"componentChunkName":"component---src-templates-blog-post-js","path":"/generics-in-golang-1.18-no-need-to-write-max-min-anymore-maybe/","result":{"data":{"site":{"siteMetadata":{"title":"TechBlog"}},"markdownRemark":{"id":"de0273c1-beef-5464-9cf1-46d2220f3477","excerpt":"One thing I do dislike in golang is that sometimes a simple task can be very tedious. One of them is getting maximum / minimum value of two integers. Backgroundâ€¦","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a00fb1c04f9a6674b58e9fc9569a7065/29114/golang.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.32911392405063%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAC4jAAAuIwF4pT92AAAB5UlEQVQoz22RXWvTUBjH93W88FPo9RD0RhniBg7XpXWLV5vMixaUMXReOFCQsWJZ643I2EUJUlPXNtqXvJmXnjQJWZI2XZVkUtPZ5m20hWytey4O5znn/P7/53nOTPBf+L7v+b4XpkHg+YHnX0T4cmaauXQ3sG371HLPeqFKuE7DYcjtkzTJbpapBMHHaXH9B/2ihGf5hm3b3b+2M+hPwGMxptnaLpOvvxa2vhO7BBsvUw+Z4yX2OCkoqCi/wmpwFoUOkPc12nOcCWfXdaIHyPUn6ys5LIei3mDg9uznlZ/xXPEws+/5vnPWSxD1Gzu7c0hR6/wat3lR9k6+dPtTdrtC3b01C2Q5CIKkqMZzhdjCg77jBv1/L3F2vlp/g5Y8171U9mhIxkkHqnAxQkBI+tSyqrpx82ni2uwdBEiKaaUIZpmSHlEi1pCC4fz9CRioWpQSIdCCCAHGwQaa39uKvV279+4wNVeklxhltWHM18BnrjFsM4THMpyiQqS4ApqrdT0mdeAyhVfzPPZl8+jbY8GAgQYDfYEUMwy4wlnS9AghROr6MqtCnLrIamsF/BlytMhqEU6LcGqU1+7TcpLmh/DUV/3pdveVVrptpQ0zbZgZw0wZ5ofRZnzysW3uNX9jujG0G8Hnavoy0nFD7PIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"golang banner\"\n        title=\"golang banner\"\n        src=\"/static/a00fb1c04f9a6674b58e9fc9569a7065/f058b/golang.png\"\n        srcset=\"/static/a00fb1c04f9a6674b58e9fc9569a7065/c26ae/golang.png 158w,\n/static/a00fb1c04f9a6674b58e9fc9569a7065/6bdcf/golang.png 315w,\n/static/a00fb1c04f9a6674b58e9fc9569a7065/f058b/golang.png 630w,\n/static/a00fb1c04f9a6674b58e9fc9569a7065/40601/golang.png 945w,\n/static/a00fb1c04f9a6674b58e9fc9569a7065/78612/golang.png 1260w,\n/static/a00fb1c04f9a6674b58e9fc9569a7065/29114/golang.png 1920w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>One thing I do dislike in golang is that sometimes a simple task can be very tedious. One of them is getting maximum / minimum value of two integers.</p>\n<h2>Background</h2>\n<p>The root cause of the tediousness of this task is the lack of generics in golang which means you can not implement a max/min function which accepts both integer and float numbers. As the built-in max function is math package accepts float64, the common fixes that peope use are:</p>\n<ul>\n<li>Write a wrapper function for math.Max or math.Min to do type conversion</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">int</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">int</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span><span class=\"token function\">Max</span><span class=\"token punctuation\">(</span><span class=\"token function\">float64</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">float64</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>Write your own max function</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">int</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> x <span class=\"token operator\">&lt;</span> y <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> y\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> x\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You might think it is not too hard to implement any of the solutions above, but it is just a totally waste of time, especially when you are joining online contests or just practicing algorithms and data structure.</p>\n<h2>Generics to the Rescue</h2>\n<p>So with the <a href=\"https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md\">new accepted proposal</a> in golang 1.18, finally we can fix this issue once and for all (if the built-in math.Max &#x26; math.Min is updated). A quick and dirty way can be done like below:</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> comparable <span class=\"token keyword\">interface</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">type</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int8</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int16</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int32</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int64</span><span class=\"token punctuation\">,</span>\n    <span class=\"token builtin\">uint</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">uint8</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">uint16</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">uint32</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">uint64</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">uintptr</span><span class=\"token punctuation\">,</span>\n    <span class=\"token builtin\">float32</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">float64</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> Max<span class=\"token punctuation\">[</span>T comparable<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y T<span class=\"token punctuation\">)</span> T <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">T</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span><span class=\"token function\">Max</span><span class=\"token punctuation\">(</span><span class=\"token function\">float64</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">float64</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>A working version <a href=\"https://go2goplay.golang.org/p/_vWgGPiuyr_s\">HERE</a></p>\n</blockquote>\n<p>If similar code like above can be added to the built-in math library, we donâ€™t need to do it ourselves anymore. I believe there are a lot more applications like this can make golang a more elegant and less-tedious language in the future. Looking forward to the release of this version next year. ðŸ˜ƒ</p>","frontmatter":{"title":"Generics in Golang 1.18, no need to write max / min anymore (maybe)","date":"June 08, 2021","description":"What can we do with generics?"}},"previous":{"fields":{"slug":"/ffmpeg-wasm-a-pure-webassembly-javascript-port-of-ffmpeg/"},"frontmatter":{"title":"FFmpeg.wasm, a pure WebAssembly / JavaScript port ofÂ FFmpeg"}},"next":null},"pageContext":{"id":"de0273c1-beef-5464-9cf1-46d2220f3477","previousPostId":"17ed182b-2490-5e17-8126-2c2e89aec275","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"]}