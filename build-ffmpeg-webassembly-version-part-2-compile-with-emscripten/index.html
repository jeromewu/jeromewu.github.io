<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.943585841b68e7816f83.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-2xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:"Noto Sans",Montserrat,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Noto Serif","Merriweather","Georgia",Cambria,"Times New Roman",Times,serif;--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5}*,:after,:before{box-sizing:border-box}html{line-height:var(--lineHeight-normal);font-size:var(--fontSize-root);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body{font-family:var(--font-body);font-size:var(--fontSize-1);color:var(--color-text)}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);height:1px;border:0}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);margin-top:var(--spacing-12);margin-bottom:var(--spacing-6);line-height:var(--lineHeight-tight);letter-spacing:-.025em}h2,h3,h4,h5,h6{font-weight:var(--fontWeight-bold);color:var(--color-heading)}h1{font-weight:var(--fontWeight-black);font-size:var(--fontSize-6);color:var(--color-heading-black)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{line-height:var(--lineHeight-relaxed);--baseline-multiplier:0.179;--x-height-multiplier:0.35;margin:var(--spacing-0) var(--spacing-0) var(--spacing-8) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{margin-left:var(--spacing-0);margin-right:var(--spacing-0);margin-bottom:var(--spacing-8);list-style-position:outside;list-style-image:none}ol li,ul li{padding-left:var(--spacing-0)}li>p,ol li,ul li{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{color:var(--color-text-light);margin-left:calc(-1*var(--spacing-6));margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6);border-left:var(--spacing-1) solid var(--color-primary);font-size:var(--fontSize-2);font-style:italic;margin-bottom:var(--spacing-8)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{width:100%;margin-bottom:var(--spacing-8);border-collapse:collapse;border-spacing:.25rem}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper);padding:var(--spacing-10) var(--spacing-5)}.global-wrapper[data-is-root-path=true] .bio{margin-bottom:var(--spacing-20)}.global-header{margin-bottom:var(--spacing-12)}.main-heading{font-size:var(--fontSize-7);margin:0}.post-list-item{margin-bottom:var(--spacing-8);margin-top:var(--spacing-8)}.post-list-item p{margin-bottom:var(--spacing-0)}.post-list-item h2{font-size:var(--fontSize-4);color:var(--color-primary);margin-bottom:var(--spacing-2);margin-top:var(--spacing-0)}.post-list-item header{margin-bottom:var(--spacing-4)}.header-link-home{font-weight:var(--fontWeight-bold);font-family:var(--font-heading);text-decoration:none;font-size:var(--fontSize-2)}.bio{display:flex;margin-bottom:var(--spacing-16)}.bio-avatar,.bio p{margin-bottom:var(--spacing-0)}.bio-avatar{margin-right:var(--spacing-4);min-width:50px;border-radius:100%}.bio-icons{margin-top:var(--spacing-4);display:flex}.bio-icon{margin-right:var(--spacing-2)}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-size:var(--fontSize-2);font-family:var(--font-heading)}.blog-post-nav ul{margin:var(--spacing-0)}.gatsby-highlight{margin-bottom:var(--spacing-8)}@media (max-width:42rem){blockquote{padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4);margin-left:var(--spacing-0)}ol,ul{list-style-position:inside}}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.24.63"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=73eaab29780e68d07df0c48cc35795ea" type="image/png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=73eaab29780e68d07df0c48cc35795ea"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=73eaab29780e68d07df0c48cc35795ea"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=73eaab29780e68d07df0c48cc35795ea"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=73eaab29780e68d07df0c48cc35795ea"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=73eaab29780e68d07df0c48cc35795ea"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=73eaab29780e68d07df0c48cc35795ea"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=73eaab29780e68d07df0c48cc35795ea"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=73eaab29780e68d07df0c48cc35795ea"/><script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>            
              (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-2729756604971245",
                enable_page_level_ads: true
              });
          </script><title data-react-helmet="true">Build FFmpeg WebAssembly version (= ffmpeg.wasm): Part.2 Compile with Emscripten | TechBlog</title><meta data-react-helmet="true" name="description" content="A series of tutorials of using Emscripten to build ffmpeg"/><meta data-react-helmet="true" property="og:title" content="Build FFmpeg WebAssembly version (= ffmpeg.wasm): Part.2 Compile with Emscripten"/><meta data-react-helmet="true" property="og:description" content="A series of tutorials of using Emscripten to build ffmpeg"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="Build FFmpeg WebAssembly version (= ffmpeg.wasm): Part.2 Compile with Emscripten"/><meta data-react-helmet="true" name="twitter:description" content="A series of tutorials of using Emscripten to build ffmpeg"/><link as="script" rel="preload" href="/webpack-runtime-3050415b2900511f8cbf.js"/><link as="script" rel="preload" href="/styles-24c541b6ac347bae38f1.js"/><link as="script" rel="preload" href="/framework-724b333f1d8feb679020.js"/><link as="script" rel="preload" href="/app-bc89759327ae4307bcc1.js"/><link as="script" rel="preload" href="/1bfc9850-3ff8877ed2e536ceab3a.js"/><link as="script" rel="preload" href="/commons-325878ffd30e0db015a9.js"/><link as="script" rel="preload" href="/cd7d5f864fc9e15ed8adef086269b0aeff617554-e27e4b84da68082679f1.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-814e0ca65094cf8ba67d.js"/><link as="fetch" rel="preload" href="/page-data/build-ffmpeg-webassembly-version-part-2-compile-with-emscripten/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/916993862.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><a class="header-link-home" href="/">TechBlog</a></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">Build FFmpeg WebAssembly version (= ffmpeg.wasm): Part.2 Compile with Emscripten</h1><p>October 13, 2019</p></header><span class="disqus-comment-count" data-disqus-identifier="e7b0e078-202f-52b5-9e84-2a39e2b3441f" data-disqus-url="https://jeromewu.github.io/build-ffmpeg-webassembly-version-part-2-compile-with-emscripten/">...</span><section itemProp="articleBody"><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/899a0ba50105cb44cf23fe8cc40b8e42/6af66/ffmpeg-wasm-cover.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.32911392405063%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABcklEQVQoz4WQUUvCUBiG+zPddRN0223/IxSDhr/AiDJkYxcGIQoiSYK7i8zE8q4N3AJRGzKtG3WDhZZkbrLtbG7rbBOtkflwLs75zvt+7znfhm3blu0AZuD4Ft083Y5UTko3d6GDUDabpWm6Xq9zHFer1ViWFUXR0Vuew95wzc5BBvLuxd4WvrN/fVgu3cfP44VCIRqNIggSDoeDwWAgEEin01BpGMbS7KHNQFNkq32m2C4DHRgusM7zvCAIcAPDW62WP/lPoMI0TQCAvZqfZtOyZqazTK/3dDolCEJV1fm1aS4y1yR74bIsr0+GTXuD4qt4OfxqwKOqKpqmwShd1xVF4QUedplMJpqL36wb+nMfe+oivY9i5YGMxc4wDEumkslUKk/kM5lM5CiC43gikUBRVJIk711zs2HowxH/9t4djQcc1yYpqgqhHTovnUeSvMrlGs0mRVEMw8C3/Ep2vyd9jkeqpqya/P/TXkp9+OoL5TdLEVHIfhB1uAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="ffmpeg wasm cover"
        title="ffmpeg wasm cover"
        src="/static/899a0ba50105cb44cf23fe8cc40b8e42/f058b/ffmpeg-wasm-cover.png"
        srcset="/static/899a0ba50105cb44cf23fe8cc40b8e42/c26ae/ffmpeg-wasm-cover.png 158w,
/static/899a0ba50105cb44cf23fe8cc40b8e42/6bdcf/ffmpeg-wasm-cover.png 315w,
/static/899a0ba50105cb44cf23fe8cc40b8e42/f058b/ffmpeg-wasm-cover.png 630w,
/static/899a0ba50105cb44cf23fe8cc40b8e42/6af66/ffmpeg-wasm-cover.png 640w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<blockquote>
<p>From here, things are going to be more complicated and hard to understand, you may need to google background knowledge if you don’t know what happened (or you can leave responses to ask me).
Also, to make this tutorial more usable, I try to write down the details of how I solved each issue, hope it will help you in building the library of your choice.</p>
</blockquote>
<p>In this part you will learn:</p>
<ol>
<li>How to setup environment of Emscripten using Docker</li>
<li>Usage of emconfigure and emmake</li>
<li>How to fix issues when compiling FFmpeg with Emscripten</li>
</ol>
<hr>
<p>How to setup environment of Emscripten using Docker
In Build FFmpeg WebAssembly version (= ffmpeg.wasm): Part.1 Preparation, we have built the original version of FFmpeg with GCC, and now we move on to use Emscripten instead.</p>
<p>The version of Emscripten we are going to use is 1.39.18 (trzeci/emscripten:1.39.18-upstream), you can install the Emscripten through the official tutorial (in this tutorial, we are setup-emsdk Github Actions in MacOS) or pull Emscripten image from docker hub.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ docker pull trzeci/emscripten:1.39.18-upstream</code></pre></div>
<blockquote>
<p>It may take few minutes as the size of the image is around 1 GB.</p>
</blockquote>
<p>Then we need to update <code class="language-text">build-with-docker.sh</code> like below:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token assign-left variable">EM_VERSION</span><span class="token operator">=</span><span class="token number">1.39</span>.18-upstream

docker pull trzeci/emscripten:<span class="token variable">$EM_VERSION</span>
docker run <span class="token punctuation">\</span>
  -v <span class="token environment constant">$PWD</span>:/src <span class="token punctuation">\</span>
  -v <span class="token environment constant">$PWD</span>/cache-wasm:/emsdk_portable/.data/cache/wasm <span class="token punctuation">\</span>
  trzeci/emscripten:<span class="token variable">$EM_VERSION</span> <span class="token punctuation">\</span>
  <span class="token function">sh</span> -c <span class="token string">'bash ./build.sh'</span></code></pre></div>
<blockquote>
<p>cache-wasm is not required, but it can help you to speed up in subsequent build.</p>
</blockquote>
<p>The next we are going to do is to find the configuration to build FFmpeg with emscripten, it is a try-and-error process and requires document digging and patient.</p>
<h2>Usage of <code class="language-text">emconfigure</code> and <code class="language-text">emmake</code> &#x26; How to fix issues when compiling FFmpeg with Emscripten</h2>
<p>Let’s start our journey of finding the right configuration. In Part.1, it starts with <code class="language-text">./configure --disable-x86asm</code>, to do it with emscripten, you need to change it to <code class="language-text">emconfigure ./configure --disable-x86asm</code>. (For details of emconfigure, please check <a href="https://emscripten.org/docs/compiling/Building-Projects.html#integrating-with-a-build-system">HERE</a>) And as we are doing cross compiling, we need to add cross-compiling flags to explicitly tell FFmpeg.</p>
<p>Let’s update <code class="language-text">build.sh</code> like below:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token comment"># verify Emscripten version</span>
emcc -v

<span class="token comment"># configure FFMpeg with Emscripten</span>
<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  --target-os<span class="token operator">=</span>none        <span class="token comment"># use none to prevent any os specific configurations</span>
  --arch<span class="token operator">=</span>x86_32           <span class="token comment"># use x86_32 to achieve minimal architectural optimization</span>
  --enable-cross-compile  <span class="token comment"># enable cross compile</span>
  --disable-x86asm        <span class="token comment"># disable x86 asm</span>
<span class="token punctuation">)</span>
emconfigure ./configure <span class="token string">"<span class="token variable">${ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span></code></pre></div>
<p>And magically there is no error or anything wrong, so do we just need to type <code class="language-text">emmake make -j</code> and we get FFmpeg.wasm? Unfortunately, the answer is no. One of the most important task for <code class="language-text">emconfigure</code> is to replace the compiler from gcc to emcc (or g++ to em++), but in the output of <code class="language-text">./configure</code>, we still get gcc as our compiler.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">emscripten sdl2-config called with /emsdk_portable/emscripten/tag-1.38.45/system/bin/sdl2-config --cflags                            
emscripten sdl2-config called with /emsdk_portable/emscripten/tag-1.38.45/system/bin/sdl2-config --libs                               
install prefix            /usr/local                                                                                                   
source path               .                                                                                                                
C compiler                gcc             # Should be emcc                                                                                             
C library                 glibc                                                                                                           
ARCH                      x86 (generic)                                                                                                     
big-endian                no                                                                                                            
runtime cpu detection     yes                                                                                                         
standalone assembly       no                                                                                                            
x86 assembler             nasm</code></pre></div>
<p>Every automation tool has its limitation and we need to do it manually in this case. Let’s check if there is any arguments to save us.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ ./configure --help</code></pre></div>
<p>Under <code class="language-text">Toolchain options</code>, there are arguments to assign the compiler to use.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">root@57ab95def750:/src# ./configure --help
Usage: configure [options]
Options: [defaults in brackets after descriptions]
Help options:
...
Toolchain options:                                                                                                             
...
  --nm=NM                  use nm tool NM [nm -g]
  --ar=AR                  use archive tool AR [ar]
  --as=AS                  use assembler AS []
  --ln_s=LN_S              use symbolic link tool LN_S [ln -s -f]
  --strip=STRIP            use strip tool STRIP [strip]
  --windres=WINDRES        use windows resource compiler WINDRES [windres]
  --x86asmexe=EXE          use nasm-compatible assembler EXE [nasm]
  --cc=CC                  use C compiler CC [gcc]
  --cxx=CXX                use C compiler CXX [g++]
  --objcc=OCC              use ObjC compiler OCC [gcc]
  --dep-cc=DEPCC           use dependency generator DEPCC [gcc]
  --nvcc=NVCC              use Nvidia CUDA compiler NVCC [nvcc]
  --ld=LD                  use linker LD []
…..</code></pre></div>
<p>Let’s pass these arguments to compile with emscripten in <code class="language-text">build.sh</code> :</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token comment"># verify Emscripten version</span>
emcc -v

<span class="token comment"># configure FFMpeg with Emscripten</span>
<span class="token assign-left variable">FLAGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  --target-os<span class="token operator">=</span>none        <span class="token comment"># use none to prevent any os specific configurations</span>
  --arch<span class="token operator">=</span>x86_32           <span class="token comment"># use x86_32 to achieve minimal architectural optimization</span>
  --enable-cross-compile  <span class="token comment"># enable cross compile</span>
  --disable-x86asm        <span class="token comment"># disable x86 asm</span>
  --nm<span class="token operator">=</span><span class="token string">"llvm-nm -g"</span>
  --ar<span class="token operator">=</span>emar
  --as<span class="token operator">=</span>llvm-as
  --ranlib<span class="token operator">=</span>llvm-ranlib
  --cc<span class="token operator">=</span>emcc
  --cxx<span class="token operator">=</span>em++
  --objcc<span class="token operator">=</span>emcc
  --dep-cc<span class="token operator">=</span>emcc
<span class="token punctuation">)</span>
emconfigure ./configure <span class="token string">"<span class="token variable">${FLAGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span></code></pre></div>
<blockquote>
<p>For native build, please make sure <code class="language-text">llvm-ranlib</code>, <code class="language-text">llvm-as</code> and <code class="language-text">llvm-nm</code> exist. If not, you can find them in <code class="language-text">$EMSDK_ROOT/upstream/bin</code> .</p>
</blockquote>
<p>With these arguments the <code class="language-text">./configure</code> will take more time to run, but you will get desired output in the end.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">emscripten sdl2-config called with /emsdk_portable/emscripten/tag-1.39.18/system/bin/sdl2-config --cflags                            
emscripten sdl2-config called with /emsdk_portable/emscripten/tag-1.39.18/system/bin/sdl2-config --libs                                     
install prefix            /usr/local                                                                                                   
source path               .                                                                                                         
C compiler                emcc         # emcc as expected                                                                                    
C library                                                                                                                          
ARCH                      x86 (generic)                                                                                                     
big-endian                no                                                                                                              
runtime cpu detection     yes                                                                                                             
standalone assembly       no</code></pre></div>
<p>Add <code class="language-text">emmake make -j4</code> (You can raise the parallelism to like <code class="language-text">-j8</code> or simply use <code class="language-text">-j</code> to use all cores) in the end of <code class="language-text">build.sh</code> :</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token comment"># verify Emscripten version</span>
emcc -v

<span class="token comment"># configure FFMpeg with Emscripten</span>
<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  --target-os<span class="token operator">=</span>none        <span class="token comment"># use none to prevent any os specific configurations</span>
  --arch<span class="token operator">=</span>x86_32           <span class="token comment"># use x86_32 to achieve minimal architectural optimization</span>
  --enable-cross-compile  <span class="token comment"># enable cross compile</span>
  --disable-x86asm        <span class="token comment"># disable x86 asm</span>
  --nm<span class="token operator">=</span><span class="token string">"llvm-nm -g"</span>
  --ar<span class="token operator">=</span>emar
  --as<span class="token operator">=</span>llvm-as
  --ranlib<span class="token operator">=</span>llvm-ranlib
  --cc<span class="token operator">=</span>emcc
  --cxx<span class="token operator">=</span>em++
  --objcc<span class="token operator">=</span>emcc
  --dep-cc<span class="token operator">=</span>emcc
<span class="token punctuation">)</span>
emconfigure ./configure <span class="token string">"<span class="token variable">${ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span>

<span class="token comment"># build ffmpeg.wasm</span>
emmake <span class="token function">make</span> -j4</code></pre></div>
<p>And it fails immediately after execution:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">...
./libavutil/x86/timer.h:39:24: error: invalid output constraint &#39;=a&#39; in asm
                     : &quot;=a&quot; (a), &quot;=d&quot; (d));
                       ^</code></pre></div>
<p>From the output message, we can identify that the error is related to asm. Open <code class="language-text">./libavutil/x86/timer.h</code> and we can confirm the issue is caused by the x86 inline assembly, which is not compatible with WebAssembly, so the solution is to disable it in <code class="language-text">build.sh</code>:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token comment"># verify Emscripten version</span>
emcc -v

<span class="token comment"># configure FFMpeg with Emscripten</span>
<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  --target-os<span class="token operator">=</span>none        <span class="token comment"># use none to prevent any os specific configurations</span>
  --arch<span class="token operator">=</span>x86_32           <span class="token comment"># use x86_32 to achieve minimal architectural optimization</span>
  --enable-cross-compile  <span class="token comment"># enable cross compile</span>
  --disable-x86asm        <span class="token comment"># disable x86 asm</span>
  --disable-inline-asm    <span class="token comment"># disable inline asm</span>
  --nm<span class="token operator">=</span><span class="token string">"llvm-nm -g"</span>
  --ar<span class="token operator">=</span>emar
  --as<span class="token operator">=</span>llvm-as
  --ranlib<span class="token operator">=</span>llvm-ranlib
  --cc<span class="token operator">=</span>emcc
  --cxx<span class="token operator">=</span>em++
  --objcc<span class="token operator">=</span>emcc
  --dep-cc<span class="token operator">=</span>emcc
<span class="token punctuation">)</span>
emconfigure ./configure <span class="token string">"<span class="token variable">${ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span>

<span class="token comment"># build ffmpeg.wasm</span>
emmake <span class="token function">make</span> -j4</code></pre></div>
<p>It works and keeps compiling until we hit another error:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">...
CC libavfilter/dnn/dnn_backend_native_layers.o
In file included from libavfilter/aeval.c:26:
In file included from ./libavutil/avassert.h:31:
In file included from ./libavutil/avutil.h:296:
In file included from ./libavutil/common.h:533:
In file included from ./libavutil/internal.h:176:
./libavutil/libm.h:54:32: error: static declaration of &#39;cbrt&#39; follows non-static declaration
static av_always_inline double cbrt(double x)
                               ^
/emsdk_portable/upstream/emscripten/system/include/libc/math.h:151:13: note: previous declaration is here
double      cbrt(double);
            ^
In file included from libavfilter/aeval.c:26:</code></pre></div>
<p>This time the root cause is not so obvious, so we need to dig deeper inside what went wrong during the <code class="language-text">./configure</code>. A very helpful file to check is <code class="language-text">ffbuild/config.log</code>, it contains logs during <code class="language-text">./configure</code> and most of time you can find the root cause there.</p>
<p>By search <code class="language-text">cbrt</code> inside <code class="language-text">config.log</code>, we find error message below:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">...
check_mathfunc cbrt 1                                                         
test_ld cc                                                                     
test_cc                                                                       
BEGIN /tmp/ffconf.syfN4Irw/test.c                                             
1 #include &lt;math.h&gt;                                                           
2 float foo(float f, float g) { return cbrt(f); }         
    3 int main(void){ return (int) foo; }                                     
END /tmp/ffconf.syfN4Irw/test.c                                               
emcc -D_ISOC99_SOURCE -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_POSIX_C_SOURCE=200112 -D_XOPEN_SOURCE=600 -std=c11 -fomit-frame-pointer -pthread -c -o /tmp/ffconf.syfN4Irw/test.o /tmp/ffconf.syfN4Irw/test.c         
emcc -Wl,-z,noexecstack -o /tmp/ffconf.syfN4Irw/test /tmp/ffconf.syfN4Irw/test.o
wasm-ld: error: &#39;atomics&#39; feature is used by /tmp/ffconf.syfN4Irw/test.o, so --shared-memory must be used
...                    </code></pre></div>
<p>This test tried to check if cbrt works in the environment, but it fails due to <code class="language-text">atomics</code> feature errored. <code class="language-text">atomics</code> is asked when you are using pthread, so let’s add <code class="language-text">pthread</code> flags. (Check <a href="https://emscripten.org/docs/porting/pthreads.html">HERE</a> for more details about pthread flags)</p>
<p>Update <code class="language-text">build.sh</code>:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token comment"># verify Emscripten version</span>
emcc -v

<span class="token comment"># configure FFMpeg with Emscripten</span>
<span class="token assign-left variable">CFLAGS</span><span class="token operator">=</span><span class="token string">"-s USE_PTHREADS"</span>
<span class="token assign-left variable">LDFLAGS</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  --target-os<span class="token operator">=</span>none        <span class="token comment"># use none to prevent any os specific configurations</span>
  --arch<span class="token operator">=</span>x86_32           <span class="token comment"># use x86_32 to achieve minimal architectural optimization</span>
  --enable-cross-compile  <span class="token comment"># enable cross compile</span>
  --disable-x86asm        <span class="token comment"># disable x86 asm</span>
  --disable-inline-asm    <span class="token comment"># disable inline asm</span>
  --extra-cflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
  --extra-cxxflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
  --extra-ldflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$LDFLAGS</span>"</span>
  --nm<span class="token operator">=</span><span class="token string">"llvm-nm -g"</span>
  --ar<span class="token operator">=</span>emar
  --as<span class="token operator">=</span>llvm-as
  --ranlib<span class="token operator">=</span>llvm-ranlib
  --cc<span class="token operator">=</span>emcc
  --cxx<span class="token operator">=</span>em++
  --objcc<span class="token operator">=</span>emcc
  --dep-cc<span class="token operator">=</span>emcc
<span class="token punctuation">)</span>
emconfigure ./configure <span class="token string">"<span class="token variable">${ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span>

<span class="token comment"># build ffmpeg.wasm</span>
emmake <span class="token function">make</span> -j4</code></pre></div>
<p>It works and keeps compiling until we hit another error:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">...
LD      ffplay_g                                                                                                                                  emcc: warning: ignoring unsupported linker flag: `-rpath-link=:libpostproc:libswresample:libswscale:libavfilter:libavdevice:libavformat:libavcodec:libavutil:libavresample` [-Wlinkflags]                                                                                                           
7 warnings generated.                                                      
wasm-ld: error: initial memory too small, 19491744 bytes needed
...                    
make: *** [Makefile:114: ffplay_g] Error 1
make: *** Waiting for unfinished jobs....
emcc: warning: ignoring unsupported linker flag: `-rpath-link=:libpostproc:libswresample:libswscale:libavfilter:libavdevice:libavformat:libavcodec
:libavutil:libavresample` [-Wlinkflags]
...</code></pre></div>
<p>This time the issue is caused by too small in initial memory (by default only 16 MB in Emscripten, and here the minimal is 19+ MB), so we need to raise the initial memory to a higher value by passing <code class="language-text">-s INITIAL_MEMORY=33554432</code> (32 MB).</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token comment"># verify Emscripten version</span>
emcc -v

<span class="token comment"># configure FFMpeg with Emscripten</span>
<span class="token assign-left variable">CFLAGS</span><span class="token operator">=</span><span class="token string">"-s USE_PTHREADS"</span>
<span class="token assign-left variable">LDFLAGS</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span> -s INITIAL_MEMORY=33554432"</span> <span class="token comment"># 33554432 bytes = 32 MB</span>
<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  --target-os<span class="token operator">=</span>none        <span class="token comment"># use none to prevent any os specific configurations</span>
  --arch<span class="token operator">=</span>x86_32           <span class="token comment"># use x86_32 to achieve minimal architectural optimization</span>
  --enable-cross-compile  <span class="token comment"># enable cross compile</span>
  --disable-x86asm        <span class="token comment"># disable x86 asm</span>
  --disable-inline-asm    <span class="token comment"># disable inline asm</span>
  --extra-cflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
  --extra-cxxflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
  --extra-ldflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$LDFLAGS</span>"</span>
  --nm<span class="token operator">=</span><span class="token string">"llvm-nm -g"</span>
  --ar<span class="token operator">=</span>emar
  --as<span class="token operator">=</span>llvm-as
  --ranlib<span class="token operator">=</span>llvm-ranlib
  --cc<span class="token operator">=</span>emcc
  --cxx<span class="token operator">=</span>em++
  --objcc<span class="token operator">=</span>emcc
  --dep-cc<span class="token operator">=</span>emcc
<span class="token punctuation">)</span>

emconfigure ./configure <span class="token string">"<span class="token variable">${ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span>

<span class="token comment"># build ffmpeg.wasm</span>
emmake <span class="token function">make</span> -j4</code></pre></div>
<p>Still there is an error after this fix:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">LD      ffplay_g
emcc: warning: ignoring unsupported linker flag: `-rpath-link=:libpostproc:libswresample:libswscale:libavfilter:libavdevice:libavformat:libavcodec:libavutil:libavresample` [-Wlinkflags]
6 warnings generated.
LD      ffmpeg_g
emcc: warning: ignoring unsupported linker flag: `-rpath-link=:libpostproc:libswresample:libswscale:libavfilter:libavdevice:libavformat:libavcodec:libavutil:libavresample` [-Wlinkflags]
9 warnings generated.
LD      ffprobe_g
emcc: warning: ignoring unsupported linker flag: `-rpath-link=:libpostproc:libswresample:libswscale:libavfilter:libavdevice:libavformat:libavcodec:libavutil:libavresample` [-Wlinkflags]
STRIP   ffmpeg
strip:ffmpeg_g: file format not recognized
make: *** [Makefile:107: ffmpeg] Error 1
make: *** Waiting for unfinished jobs....</code></pre></div>
<p>As we are unable to strip (make sense as it is not in a valid binary format), let’s simply disable strip with <code class="language-text">--disable-stripping</code> and make again:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token comment"># verify Emscripten version</span>
emcc -v

<span class="token comment"># configure FFMpeg with Emscripten</span>
<span class="token assign-left variable">CFLAGS</span><span class="token operator">=</span><span class="token string">"-s USE_PTHREADS"</span>
<span class="token assign-left variable">LDFLAGS</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span> -s INITIAL_MEMORY=33554432"</span> <span class="token comment"># 33554432 bytes = 32 MB</span>
<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  --target-os<span class="token operator">=</span>none        <span class="token comment"># use none to prevent any os specific configurations</span>
  --arch<span class="token operator">=</span>x86_32           <span class="token comment"># use x86_32 to achieve minimal architectural optimization</span>
  --enable-cross-compile  <span class="token comment"># enable cross compile</span>
  --disable-x86asm        <span class="token comment"># disable x86 asm</span>
  --disable-inline-asm    <span class="token comment"># disable inline asm</span>
  --disable-stripping     <span class="token comment"># disable stripping</span>
  --extra-cflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
  --extra-cxxflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
  --extra-ldflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$LDFLAGS</span>"</span>
  --nm<span class="token operator">=</span><span class="token string">"llvm-nm -g"</span>
  --ar<span class="token operator">=</span>emar
  --as<span class="token operator">=</span>llvm-as
  --ranlib<span class="token operator">=</span>llvm-ranlib
  --cc<span class="token operator">=</span>emcc
  --cxx<span class="token operator">=</span>em++
  --objcc<span class="token operator">=</span>emcc
  --dep-cc<span class="token operator">=</span>emcc
<span class="token punctuation">)</span>

emconfigure ./configure <span class="token string">"<span class="token variable">${ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span>

<span class="token comment"># build ffmpeg.wasm</span>
emmake <span class="token function">make</span> -j4</code></pre></div>
<p>Finally we managed to successfully do the <code class="language-text">emmake make -j</code> part and you can see ffplay / ffplay_g, ffprobe / ffprobe_g and ffmpeg / ffmpeg_g generated in the root folder. It looks perfect, but there is a weird _g suffix makes the output files like this:</p>
<ul>
<li>ffmpeg</li>
<li>ffmpeg_g</li>
<li>ffmpeg_g.wasm</li>
<li>ffmpeg_g.worker.js</li>
</ul>
<p>Both ffmpeg and ffmpeg_g here are actualy js files, the ideal naming is like below:</p>
<ul>
<li>ffmpeg / ffmpeg_g => ffmpeg.js</li>
<li>ffmpeg_g.wasm => ffmpeg.wasm</li>
<li>ffmpeg_g.worker.js => ffmpeg.worker.js</li>
</ul>
<p>To fix this issue, we need to build it by our own. The command to build ffmpeg can be extracted by running <code class="language-text">emmake make -n</code>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">...
printf &quot;LD\t%s\n&quot; ffmpeg_g; emcc -Llibavcodec -Llibavdevice -Llibavfilter -Llibavformat -Llibavresample -Llibavutil -Llibpostproc -Llibswscale -Llibswresample -Wl,--as-needed -Wl,-z,noexecstack -Wl,--warn-common -Wl,-rpath-link=libpostproc:libswresample:libswscale:libavfilter:libavdevice:libavformat:libavcodec:libavutil:libavresample -Qunused-arguments   -o ffmpeg_g fftools/ffmpeg_opt.o fftools/ffmpeg_filter.o fftools/ffmpeg_hw.o fftools/cmdutils.o fftools/ffmpeg.o  -lavdevice -lavfilter -lavformat -lavcodec -lswresample -lswscale -lavutil  -lm -pthread -lm -lm -pthread -lm -lm -lm -pthread -lm
printf &quot;CP\t%s\n&quot; ffmpeg; cp -p ffmpeg_g ffmpeg
…..</code></pre></div>
<p>With a little clean up:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">emcc \
  -I. -I./fftools \
  -Llibavcodec -Llibavdevice -Llibavfilter -Llibavformat -Llibavresample -Llibavutil -Llibpostproc -Llibswscale -Llibswresample \
  -Qunused-arguments \
  -o ffmpeg_g fftools/ffmpeg_opt.o fftools/ffmpeg_filter.o fftools/ffmpeg_hw.o fftools/cmdutils.o fftools/ffmpeg.o \
  -lavdevice -lavfilter -lavformat -lavcodec -lswresample -lswscale -lavutil -lm</code></pre></div>
<p>As we are building our own version, let’s add <code class="language-text">--disable-programs</code> and <code class="language-text">--disable-doc</code> in <code class="language-text">./configure</code> step to speed up the build and also add some essential flags when build ffmpeg</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash -x</span>

<span class="token comment"># verify Emscripten version</span>
emcc -v

<span class="token comment"># configure FFMpeg with Emscripten</span>
<span class="token assign-left variable">CFLAGS</span><span class="token operator">=</span><span class="token string">"-s USE_PTHREADS"</span>
<span class="token assign-left variable">LDFLAGS</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span> -s INITIAL_MEMORY=33554432"</span> <span class="token comment"># 33554432 bytes = 32 MB</span>
<span class="token assign-left variable">CONFIG_ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  --target-os<span class="token operator">=</span>none        <span class="token comment"># use none to prevent any os specific configurations</span>
  --arch<span class="token operator">=</span>x86_32           <span class="token comment"># use x86_32 to achieve minimal architectural optimization</span>
  --enable-cross-compile  <span class="token comment"># enable cross compile</span>
  --disable-x86asm        <span class="token comment"># disable x86 asm</span>
  --disable-inline-asm    <span class="token comment"># disable inline asm</span>
  --disable-stripping     <span class="token comment"># disable stripping</span>
  --disable-programs      <span class="token comment"># disable programs build (incl. ffplay, ffprobe &amp; ffmpeg)</span>
  --disable-doc           <span class="token comment"># disable doc</span>
  --extra-cflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
  --extra-cxxflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$CFLAGS</span>"</span>
  --extra-ldflags<span class="token operator">=</span><span class="token string">"<span class="token variable">$LDFLAGS</span>"</span>
  --nm<span class="token operator">=</span><span class="token string">"llvm-nm -g"</span>
  --ar<span class="token operator">=</span>emar
  --as<span class="token operator">=</span>llvm-as
  --ranlib<span class="token operator">=</span>llvm-ranlib
  --cc<span class="token operator">=</span>emcc
  --cxx<span class="token operator">=</span>em++
  --objcc<span class="token operator">=</span>emcc
  --dep-cc<span class="token operator">=</span>emcc
<span class="token punctuation">)</span>
emconfigure ./configure <span class="token string">"<span class="token variable">${CONFIG_ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span>

<span class="token comment"># build dependencies</span>
emmake <span class="token function">make</span> -j4

<span class="token comment"># build ffmpeg.wasm</span>
<span class="token function">mkdir</span> -p wasm/dist
<span class="token assign-left variable">ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span>
  -I. -I./fftools
  -Llibavcodec -Llibavdevice -Llibavfilter -Llibavformat -Llibavresample -Llibavutil -Llibpostproc -Llibswscale -Llibswresample
  -Qunused-arguments
  -o wasm/dist/ffmpeg.js fftools/ffmpeg_opt.c fftools/ffmpeg_filter.c fftools/ffmpeg_hw.c fftools/cmdutils.c fftools/ffmpeg.c
  -lavdevice -lavfilter -lavformat -lavcodec -lswresample -lswscale -lavutil -lm
  -s <span class="token assign-left variable">USE_SDL</span><span class="token operator">=</span><span class="token number">2</span>                    <span class="token comment"># use SDL2</span>
  -s <span class="token assign-left variable">USE_PTHREADS</span><span class="token operator">=</span><span class="token number">1</span>               <span class="token comment"># enable pthreads support</span>
  -s <span class="token assign-left variable">INITIAL_MEMORY</span><span class="token operator">=</span><span class="token number">33554432</span>      <span class="token comment"># 33554432 bytes = 32 MB</span>
<span class="token punctuation">)</span>
emcc <span class="token string">"<span class="token variable">${ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span></code></pre></div>
<p>Let’s create a <a href="https://github.com/ffmpegwasm/FFmpeg/blob/n4.3.1-p2/wasm/basic.html">basic.html</a> to test if ffmpeg.wasm is working:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./dist/ffmpeg.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre></div>
<p>Run a lightweight web server (ex. <code class="language-text">python3 -m http.server 3000</code>) and visit the web page (ex. <a href="http://localhost:3000/basic.html">http://localhost:3000/basic.html</a>) and open the Chrome DevTools.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3b546c69d78cf5ea27677d9dae1afa6f/dc61a/output.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABDUlEQVQY03WQ2W6DMBRE+f8f60NZAmnIBhSKETRgY8BmMVuH0Ep9aKWj0Ui+y1xrkposM6vHocwMluos06G7z+MX/rDq3BbsbRB3oKQHeuFnxKrZRRMUbWZDj1tPamBKV1+V9IfmDtM3N8ldqGoDJYMR2vqD8GjmyOqmdfxQ5XbfXKv8gCV4W5d0ncg6JeucfOtuNgi86kISGjx3tY5Z/NPqqguWt/w8Sn+rGON/mcjYhWlsVhSxi1eWGjgSINU2fisiP/zR3IsgiQxenHGzXudOU9i4FsegYVHxPERzH0Lhn0Ge7GZKVPtOIqMsXK0tLVGeGuogM35V8pOgx0F6GAT2Eb9Z1McggzS2EPsLZaSDkN2YsKcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="output"
        title="output"
        src="/static/3b546c69d78cf5ea27677d9dae1afa6f/f058b/output.png"
        srcset="/static/3b546c69d78cf5ea27677d9dae1afa6f/c26ae/output.png 158w,
/static/3b546c69d78cf5ea27677d9dae1afa6f/6bdcf/output.png 315w,
/static/3b546c69d78cf5ea27677d9dae1afa6f/f058b/output.png 630w,
/static/3b546c69d78cf5ea27677d9dae1afa6f/40601/output.png 945w,
/static/3b546c69d78cf5ea27677d9dae1afa6f/dc61a/output.png 1147w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>It is kind of working as you can see output similar to original FFmpeg, it gives us a good starting point to polish our ffmpeg.wasm library.</p>
<p>You can visit the repository here to see how it works in details: <a href="https://github.com/ffmpegwasm/FFmpeg/tree/n4.3.1-p2">https://github.com/ffmpegwasm/FFmpeg/tree/n4.3.1-p2</a></p>
<p>And feel free to download the build artifacts here: <a href="https://github.com/ffmpegwasm/FFmpeg/releases/tag/n4.3.1-p2">https://github.com/ffmpegwasm/FFmpeg/releases/tag/n4.3.1-p2</a></p>
<hr>
<p>For how to polish and create a “real” ffmpeg.wasm library, please see next post in this series of stories. 😃</p></section><hr/><footer><div class="bio"><div class="bio-avatar gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAUEA//EABYBAQEBAAAAAAAAAAAAAAAAAAECAP/aAAwDAQACEAMQAAABnaOm2ahqJiNYHRBn/8QAGhAAAwADAQAAAAAAAAAAAAAAAQIDABESBP/aAAgBAQABBQIJwiz6y0eKbBEBnouq1Q6b0UYSJ3n/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAdEAACAgIDAQAAAAAAAAAAAAAAAREhAhIiMWGC/9oACAEBAAY/ApjkJvV3aIx6F6SRrixH0Wf/xAAaEAADAAMBAAAAAAAAAAAAAAAAAREhMVFB/9oACAEBAAE/IZ8m3fB7spjpB7KPdXAs9XCM1avqHKpK28jZOmx3LYxq1bP/2gAMAwEAAgADAAAAEOjQwP/EABYRAAMAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxCCIr//xAAZEQEAAgMAAAAAAAAAAAAAAAABABARITH/2gAIAQIBAT8QXcyw5X//xAAcEAEBAQEAAwEBAAAAAAAAAAABEQAhQVFxYZH/2gAIAQEAAT8QJtKdFK07KEbRlmHRhU1PjpcjL5l9YDglEAjxJ/NTFCgr6vyZYfQJ+NxBLPfqZOxFV87/2Q==" alt="Jerome Wu / Wen-Chieh Wu / 吳文傑" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/88fbe1fab67fa2b71b5fcfa4854a6ece/340ed/profile-pic.jpg 1x,
/static/88fbe1fab67fa2b71b5fcfa4854a6ece/32ce1/profile-pic.jpg 1.5x,
/static/88fbe1fab67fa2b71b5fcfa4854a6ece/04d41/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/88fbe1fab67fa2b71b5fcfa4854a6ece/340ed/profile-pic.jpg 1x,
/static/88fbe1fab67fa2b71b5fcfa4854a6ece/32ce1/profile-pic.jpg 1.5x,
/static/88fbe1fab67fa2b71b5fcfa4854a6ece/04d41/profile-pic.jpg 2x" src="/static/88fbe1fab67fa2b71b5fcfa4854a6ece/340ed/profile-pic.jpg" alt="Jerome Wu / Wen-Chieh Wu / 吳文傑" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><div class="bio-intro"><p>Written by <strong>Jerome Wu / Wen-Chieh Wu / 吳文傑</strong><br/> <!-- -->Mantainer of tesseract.js and ffmpeg.wasm. Here is my personal writtings about software technologies</p><p class="bio-icons"><a class="bio-icon" href="https://github.com/jeromewu" rel="noopener noreferrer" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" color="#4f5969" style="color:#4f5969" height="1.5em" width="1.5em" xmlns="http://www.w3.org/2000/svg"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg></a><a class="bio-icon" href="https://www.linkedin.com/in/wenchiehwu/" rel="noopener noreferrer" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" color="#4f5969" style="color:#4f5969" height="1.5em" width="1.5em" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a class="bio-icon" href="https://medium.com/@jeromewus" rel="noopener noreferrer" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" color="#4f5969" style="color:#4f5969" height="1.5em" width="1.5em" xmlns="http://www.w3.org/2000/svg"><path d="M0 32v448h448V32H0zm372.2 106.1l-24 23c-2.1 1.6-3.1 4.2-2.7 6.7v169.3c-.4 2.6.6 5.2 2.7 6.7l23.5 23v5.1h-118V367l24.3-23.6c2.4-2.4 2.4-3.1 2.4-6.7V199.8l-67.6 171.6h-9.1L125 199.8v115c-.7 4.8 1 9.7 4.4 13.2l31.6 38.3v5.1H71.2v-5.1l31.6-38.3c3.4-3.5 4.9-8.4 4.1-13.2v-133c.4-3.7-1-7.3-3.8-9.8L75 138.1V133h87.3l67.4 148L289 133.1h83.2v5z"></path></svg></a><a class="bio-icon" href="https://jeromewu.github.io/doc/resume.pdf" rel="noopener noreferrer" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" color="#4f5969" style="color:#4f5969" height="1.5em" width="1.5em" xmlns="http://www.w3.org/2000/svg"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"></path></svg></a></p></div></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/build-ffmpeg-webassembly-version-part-1-preparation/">← <!-- -->Build FFmpeg WebAssembly version (= ffmpeg.wasm): Part.1 Preparation</a></li><li><a rel="next" href="/build-ffmpeg-webassembly-version-part-3-v0.1/">Build FFmpeg WebAssembly version (= ffmpeg.wasm): Part.3 ffmpeg.wasm v0.1 — Transcoding avi to mp4<!-- --> →</a></li></ul></nav><div id="disqus_thread"></div></main><footer>© <!-- -->2022<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.com">Gatsby</a> <!-- -->and<!-- --> <a href="https://github.com/gatsbyjs/gatsby-starter-blog">gatsby-starter-blog</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-179270444-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/build-ffmpeg-webassembly-version-part-2-compile-with-emscripten/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-ae95585a1f020bad92fc.js"],"app":["/app-bc89759327ae4307bcc1.js"],"component---src-pages-404-js":["/component---src-pages-404-js-bd5811948f37ef480fa7.js"],"component---src-pages-index-js":["/component---src-pages-index-js-20cb0bf2ca7f27bf86f1.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-94982706ff67d8be0865.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-814e0ca65094cf8ba67d.js"]};/*]]>*/</script><script src="/polyfill-ae95585a1f020bad92fc.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-814e0ca65094cf8ba67d.js" async=""></script><script src="/cd7d5f864fc9e15ed8adef086269b0aeff617554-e27e4b84da68082679f1.js" async=""></script><script src="/commons-325878ffd30e0db015a9.js" async=""></script><script src="/1bfc9850-3ff8877ed2e536ceab3a.js" async=""></script><script src="/app-bc89759327ae4307bcc1.js" async=""></script><script src="/framework-724b333f1d8feb679020.js" async=""></script><script src="/styles-24c541b6ac347bae38f1.js" async=""></script><script src="/webpack-runtime-3050415b2900511f8cbf.js" async=""></script></body></html>