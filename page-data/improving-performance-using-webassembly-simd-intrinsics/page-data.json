{"componentChunkName":"component---src-templates-blog-post-js","path":"/improving-performance-using-webassembly-simd-intrinsics/","result":{"data":{"site":{"siteMetadata":{"title":"TechBlog"}},"markdownRemark":{"id":"6be00fd6-4794-55ae-a35b-d3d975cb6e68","excerpt":"WebAssembly is a technology famous of boosting performance of web applications,\nbut what might be the best practice to do achieve maximum performance and what…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9356b5cd4ee6e8beba075ef0abd5af2f/1307b/wa-logo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.45569620253164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6UlEQVQ4y42TQWtTQRDHNzZfpuBREEFti9pKNLuv0ZrYZ9Wku7UpesgTDw8VtGhBL0VUPFr15qWnHhTxULx4UERF/BJ5MyStSbrhjey8p7xLkww8Znbff37M7uwIkTEtQWgFOa1QaInCsAf22dj9Y43TShD7mpZwgKESjmoJ61rBmpZwLwO8n+6tpxrOGQDEfCoKtUIyCklL98GGlvDKxZm9MNFifn+gwrxWDGykyR2tsG8UMMgo6BvJe8Qap1VDgXy8QEuGWONhvOQ5KPbT2CZVQpDc+QhAJ3ZJtbNgrxYgvnIaqFoAcvHCNNikWgz4XkcBXith4CCPw7Z98Wgn3ni6S88e7tDLJ7vxx60uAxeLEFTPcNdHAM4mwAc32/bzdi/+9c3S1tsObb7pxD++7Nnbyy2qTEZBZTJypxneFONhY7EIdL2M3d/frf30oWe33/fsu82u/fl1r/v6+R+Sh5qNmYPNIRWmz8YoDLkpHtLarTbdqbdctXR3pUU3KkirjRZdnoHw0ikQS7ODgbn02YwbhTUtYf7C8cj3T4Bfnoh8/yT41QLMX5yKasslHK+f4wbmBk3K/3HiDhZBeIebYu5YJEpHIlGeiMTCNPC6fh7FyhwOGT1+qFyhq3TMKBj757Ox86mG9Vn7C1aJgk5gelXsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"WebAssembly Logo\"\n        title=\"WebAssembly Logo\"\n        src=\"/static/9356b5cd4ee6e8beba075ef0abd5af2f/f058b/wa-logo.png\"\n        srcset=\"/static/9356b5cd4ee6e8beba075ef0abd5af2f/c26ae/wa-logo.png 158w,\n/static/9356b5cd4ee6e8beba075ef0abd5af2f/6bdcf/wa-logo.png 315w,\n/static/9356b5cd4ee6e8beba075ef0abd5af2f/f058b/wa-logo.png 630w,\n/static/9356b5cd4ee6e8beba075ef0abd5af2f/40601/wa-logo.png 945w,\n/static/9356b5cd4ee6e8beba075ef0abd5af2f/78612/wa-logo.png 1260w,\n/static/9356b5cd4ee6e8beba075ef0abd5af2f/1307b/wa-logo.png 3000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>WebAssembly is a technology famous of boosting performance of web applications,\nbut what might be the best practice to do achieve maximum performance and what\nis the cost is what we are going to discuss in this post.</p>\n<p>To begin with, let’s talk about how developers develop WebAssembly applications based\non the result of <a href=\"https://blog.scottlogic.com/2022/06/20/state-of-wasm-2022.html\">The State of WebAssembly\n2022</a>. The top 3\nlanguages used to develop WebAssembly are Rust, JavaScript and C/C++.\n(JavaScript come in second place due to QuickJS, a tiny JS VM, is ported to\nWebAssembly and boosts JavaScript runtime performance) As Rust and C/C++ are\ntop languages, it is common that developers develop Rust or C/C++\nprograms and compile to WebAssembly.</p>\n<p>Take C/C++ as an example, usually you might use GCC to compile like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">gcc -o main main.c</code></pre></div>\n<p>When you want to compile to WebAssembly, you might use <a href=\"https://emscripten.org/\">Emscripten</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">emcc -o main.js main.c\n<span class=\"token comment\"># or</span>\nemcc -o main.wasm main.c</code></pre></div>\n<p>Then you can use NodeJS or runtime like wasmtime or wasmer to run the program.</p>\n<p>But is that the end of the story? Maybe not. Let’s use a <a href=\"https://en.wikipedia.org/wiki/Matrix_multiplication\">matrix\nmultiplication</a>\nas example to benchmark:</p>\n<p>JavaScript Version (<a href=\"https://github.com/jeromewu/wasm-perf/blob/main/mul_mats.js\">Source Code</a>):</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// in_b is transposed to speed up multiplication.</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mulMats</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">out<span class=\"token punctuation\">,</span> in_a<span class=\"token punctuation\">,</span> in_b<span class=\"token punctuation\">,</span> n</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      out<span class=\"token punctuation\">.</span>arr<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> k <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        out<span class=\"token punctuation\">.</span>arr<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> in_a<span class=\"token punctuation\">.</span>arr<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> in_b<span class=\"token punctuation\">.</span>arr<span class=\"token punctuation\">[</span>j<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>C Version (<a href=\"https://github.com/jeromewu/wasm-perf/blob/main/mul_mats.c\">Source Code</a>):</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// in_b is transposed to speed up multiplication.</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">multiply_mats</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span> out<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">*</span> in_a<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">*</span> in_b<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      out<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        out<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> in_a<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> in_b<span class=\"token punctuation\">[</span>j<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The performance of JavaScript version, C version and WebAssembly version:</p>\n<table>\n<thead>\n<tr>\n<th>Version</th>\n<th>Time to Complete</th>\n<th>Remark</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>JavaScript</td>\n<td>5.768s</td>\n<td>NodeJS v16.16.0</td>\n</tr>\n<tr>\n<td>C</td>\n<td>7.697s</td>\n<td>GCC 12.2.0</td>\n</tr>\n<tr>\n<td>WebAssembly</td>\n<td>6.865s</td>\n<td>Emscripten 3.1.18</td>\n</tr>\n</tbody>\n</table>\n<p>It might be unexpected to see that JavaScript version is the fastest one, it is\nsimply because this is NOT a fair comparison as we didn’t use flags to optimize\nperformance.</p>\n<p>One of the most significant flag we can use here is <code class=\"language-text\">-O3</code>, let’s add this flag\nand below is the result:</p>\n<table>\n<thead>\n<tr>\n<th>Version</th>\n<th>Time to Complete</th>\n<th>Remark</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>JavaScript</td>\n<td>5.768s</td>\n<td>NodeJS v16.16.0</td>\n</tr>\n<tr>\n<td>C</td>\n<td>0.401s</td>\n<td>GCC 12.2.0</td>\n</tr>\n<tr>\n<td>WebAssembly</td>\n<td>2.012s</td>\n<td>Emscripten 3.1.18</td>\n</tr>\n</tbody>\n</table>\n<p>With a simple flag, now WebAssembly version is around 65% faster!</p>\n<p>But how might we improve the performance even more? Let’s discuss what options\nwe have.</p>\n<h2>Methods to Improve Performance</h2>\n<p>There are mainly three approaches to improve performance:</p>\n<ol>\n<li>More optimization flags</li>\n<li>Use multi-thread</li>\n<li>Use SIMD intrinsics</li>\n</ol>\n<h3>More optimization flags</h3>\n<p>More optimization flags like <code class=\"language-text\">-flto</code> might improve performance, but sometimes it\nmight introduce side effects, so it is essential to do more tests when using\nmore flags.</p>\n<h3>Use multi-thread</h3>\n<p>WebAssembly supports multi-thread, so you can use libraries like pthread to\nachieve multi-threading. It works but with a major drawback: SharedArrayBuffer.</p>\n<p>SharedArrayBuffer is an essential technology behind multi-threading in\nWebAssembly. It enables threads (which is web worker in browser) to communicate\nwith each other. But it also consumes more memory and suffers from browser\ncompatibility issue. (Mainly mobile browsers)</p>\n<p>SharedArrayBuffer compatibility: <a href=\"https://caniuse.com/sharedarraybuffer\">https://caniuse.com/sharedarraybuffer</a></p>\n<h3>Use SIMD intrinsics</h3>\n<p>SIMD (Single Instruction, Multiple Data) is a type of parallel processing\nsupported by WebAssembly. In Emscripten, you can add flag <code class=\"language-text\">-msimd128</code> to\nenable SIMD and improve performance for free:</p>\n<table>\n<thead>\n<tr>\n<th>Version</th>\n<th>Time to Complete</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>JavaScript</td>\n<td>5.768s</td>\n</tr>\n<tr>\n<td>C</td>\n<td>0.401s</td>\n</tr>\n<tr>\n<td>WebAssembly</td>\n<td>2.012s</td>\n</tr>\n<tr>\n<td>WebAssembly (w/ -msimd128)</td>\n<td>0.278s</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p><code class=\"language-text\">-O3</code> flag comes with auto-vectorization, so it is better to use <code class=\"language-text\">-msimd128</code>\nwith <code class=\"language-text\">-O3</code></p>\n</blockquote>\n<p>Wow, now our performance is so good that it is even faster than C version! But\nit is not the end of the story as we haven’t used our secret weapon: <strong>SIMD\nintrinsics</strong>.</p>\n<p>SIMD intrinsics are low-level functions to enable developers to write assembly\ncode in a more user-friendly way. It is supported not only in Emscripten, but\nalso other major languages like Rust and AssemblyScript. With SIMD intrinsics,\nwe can rewrite our code to improve performance further more:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// in_b is transposed to speed up multiplication.</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">multiply_mats</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span> out<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">*</span> in_a<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">*</span> in_b<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      out<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">int</span> sum_arr<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token class-name\">v128_t</span> sum <span class=\"token operator\">=</span> <span class=\"token function\">wasm_v128_load</span><span class=\"token punctuation\">(</span>sum_arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> k<span class=\"token operator\">+=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">v128_t</span> a <span class=\"token operator\">=</span> <span class=\"token function\">wasm_v128_load</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>in_a<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">v128_t</span> b <span class=\"token operator\">=</span> <span class=\"token function\">wasm_v128_load</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>in_b<span class=\"token punctuation\">[</span>j<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">v128_t</span> prod <span class=\"token operator\">=</span> <span class=\"token function\">wasm_i32x4_mul</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        sum <span class=\"token operator\">=</span> <span class=\"token function\">wasm_i32x4_add</span><span class=\"token punctuation\">(</span>sum<span class=\"token punctuation\">,</span> prod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token class-name\">v128_t</span> sum_duo <span class=\"token operator\">=</span> <span class=\"token function\">wasm_i32x4_add</span><span class=\"token punctuation\">(</span>sum<span class=\"token punctuation\">,</span> <span class=\"token function\">wasm_i32x4_shuffle</span><span class=\"token punctuation\">(</span>sum<span class=\"token punctuation\">,</span> sum<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token class-name\">v128_t</span> sum_one <span class=\"token operator\">=</span> <span class=\"token function\">wasm_i32x4_add</span><span class=\"token punctuation\">(</span>sum_duo<span class=\"token punctuation\">,</span> <span class=\"token function\">wasm_i32x4_shuffle</span><span class=\"token punctuation\">(</span>sum_duo<span class=\"token punctuation\">,</span> sum_duo<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      out<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>n<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token function\">wasm_i32x4_extract_lane</span><span class=\"token punctuation\">(</span>sum_one<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<table>\n<thead>\n<tr>\n<th>Version</th>\n<th>Time to Complete</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>JavaScript</td>\n<td>5.768s</td>\n</tr>\n<tr>\n<td>C</td>\n<td>0.401s</td>\n</tr>\n<tr>\n<td>WebAssembly</td>\n<td>2.012s</td>\n</tr>\n<tr>\n<td>WebAssembly (w/ -msimd128)</td>\n<td>0.278s</td>\n</tr>\n<tr>\n<td>WebAssembly w/ SIMD intrinsics (w/ -msimd128)</td>\n<td>0.245s</td>\n</tr>\n</tbody>\n</table>\n<p>As the result, we are <strong>95.8%</strong> faster than the original JavaScript version!</p>\n<h2>Conclusion</h2>\n<p>In this post, we visited a few methods to improve WebAssembly performance, and\nfinally we achieve a much better performance by using SIMD intrinsics. Although\nit looks perfect, but there is actually a pretty steep learning curve to learn\nSIMD intrinsics and master it. And you might only get less than 1% performance\nimprovement if your program is already auto-vectorized by the compiler. So the\nbest bet is to use <code class=\"language-text\">-O3 -msimd128</code> flags first and rewrite the most computing\nintensive parts in your code using SIMD intrinsics to improve the performance\nlittle by little.</p>\n<p>Hope you enjoy this post. :) Feel free to leave comments and try to run the code\nusing the source code in this repository: <a href=\"https://github.com/jeromewu/wasm-perf\">https://github.com/jeromewu/wasm-perf</a></p>","frontmatter":{"title":"Improving performance using WebAssembly SIMD Intrinsics","date":"August 26, 2022","description":"Faster, but with a steep learning curve."}},"previous":{"fields":{"slug":"/generics-in-golang-1.18-no-need-to-write-max-min-anymore-maybe/"},"frontmatter":{"title":"Generics in Golang 1.18, no need to write max / min anymore (maybe)"}},"next":null},"pageContext":{"id":"6be00fd6-4794-55ae-a35b-d3d975cb6e68","previousPostId":"de0273c1-beef-5464-9cf1-46d2220f3477","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"]}